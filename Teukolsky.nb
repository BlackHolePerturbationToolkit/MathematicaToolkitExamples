(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15502,        443]
NotebookOptionsPosition[     11704,        367]
NotebookOutlinePosition[     12064,        383]
CellTagsIndexPosition[     12021,        380]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Examples using the Teukolsky package", "Title",
 CellChangeTimes->{{3.738865163356645*^9, 
  3.738865171609845*^9}},ExpressionUUID->"6dfb92db-8d2f-412c-a2d2-\
ed2ea57ae5a7"],

Cell["\<\
This package is still in heavy development. This notebook demonstrates some \
of the currently implemented features.\
\>", "Text",
 CellChangeTimes->{{3.738866106989403*^9, 3.738866132741541*^9}, {
  3.7388661663262863`*^9, 
  3.7388661668516006`*^9}},ExpressionUUID->"ff74de42-b70c-4674-8db3-\
9eb3faa7e0d0"],

Cell[BoxData[
 RowBox[{"<<", "Teukolsky`"}]], "Input",
 CellChangeTimes->{{3.767811317213812*^9, 
  3.767811319830332*^9}},ExpressionUUID->"fd89dbdb-cda3-401f-ba0a-\
942277a30a33"],

Cell[CellGroupData[{

Cell["Homogeneous solutions", "Section",
 CellChangeTimes->{{3.7678114536819077`*^9, 
  3.767811457896558*^9}},ExpressionUUID->"fb2c01ff-5454-49d0-b084-\
3d9988dd42a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R", "=", 
  RowBox[{"TeukolskyRadial", "[", 
   RowBox[{
    RowBox[{"-", "2"}], ",", "2", ",", "2", ",", "0.9", ",", "0.1"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.767811594822134*^9, 
  3.7678116077313633`*^9}},ExpressionUUID->"af0605f7-369b-4356-94a4-\
00eaa2af7dc6"],

Cell[BoxData["\<\"TeukolskyRadialFunction[-2,2,2,0.9,0.1,<<>>]\"\>"], "Output",
 CellChangeTimes->{{3.7678116037219*^9, 
  3.767811608184579*^9}},ExpressionUUID->"7302a87c-a1f3-4326-8fcf-\
b152f7ecb80e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"R", "[", "10.", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "\"\<In\>\"", "]"}], "[", "10.", "]"}]}], "Input",
 CellChangeTimes->{{3.7678116088223457`*^9, 
  3.7678116784880953`*^9}},ExpressionUUID->"aed6e67a-c34c-4d43-a88c-\
46eddcdcfd7a"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"In\"\>", "\[Rule]", 
    RowBox[{"6463.619047891582`", "\[VeryThinSpace]", "+", 
     RowBox[{"2139.2500572121767`", " ", "\[ImaginaryI]"}]}]}], ",", 
   RowBox[{"\<\"Up\"\>", "\[Rule]", 
    RowBox[{"642.4758814240146`", "\[VeryThinSpace]", "-", 
     RowBox[{"546.1721109846782`", " ", "\[ImaginaryI]"}]}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.76781161134972*^9, 3.767811618984799*^9}, {
  3.7678116525510674`*^9, 
  3.767811678754078*^9}},ExpressionUUID->"0cc86216-b97b-422b-8bd2-\
3800c6d6d575"],

Cell[BoxData[
 RowBox[{"6463.619047891582`", "\[VeryThinSpace]", "+", 
  RowBox[{"2139.2500572121767`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.76781161134972*^9, 3.767811618984799*^9}, {
  3.7678116525510674`*^9, 
  3.7678116787893267`*^9}},ExpressionUUID->"aa3a311d-364e-437b-abd4-\
51e001f1859f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "'"}], "[", "10.", "]"}]], "Input",ExpressionUUID->"757634c5-7c09-4347-98a9-6ea5de596742"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"In\"\>", "\[Rule]", 
    RowBox[{"2599.2351697723293`", "\[VeryThinSpace]", "+", 
     RowBox[{"1501.959691500904`", " ", "\[ImaginaryI]"}]}]}], ",", 
   RowBox[{"\<\"Up\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "311.5746445550495`"}], "+", 
     RowBox[{"18.08158464835381`", " ", "\[ImaginaryI]"}]}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.7678116557628736`*^9},ExpressionUUID->"b813770d-457e-4632-8136-\
0b0ffa998873"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "''"}], "[", "10.", "]"}]], "Input",
 CellChangeTimes->{{3.767811656482354*^9, 
  3.767811658079711*^9}},ExpressionUUID->"5beb6aff-5e83-48d3-989c-\
d7bcb06b70c7"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"In\"\>", "\[Rule]", 
    RowBox[{"669.0882376750615`", "\[VeryThinSpace]", "+", 
     RowBox[{"746.9606445076068`", " ", "\[ImaginaryI]"}]}]}], ",", 
   RowBox[{"\<\"Up\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "19.963910049217446`"}], "+", 
     RowBox[{"21.04276475398636`", " ", "\[ImaginaryI]"}]}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.767811658671446*^9},ExpressionUUID->"b4aeba20-e729-426c-ae7b-\
babe86242998"]
}, Open  ]],

Cell["\<\
Using the field equation the package will allow you to take as many \
derivatives as you want\
\>", "Text",
 CellChangeTimes->{{3.767811946247698*^9, 
  3.767811972525619*^9}},ExpressionUUID->"a825781f-82aa-447e-a69f-\
f422113e978e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "'''''"}], "[", "10.", "]"}]], "Input",
 CellChangeTimes->{{3.7678116593480797`*^9, 
  3.767811662191802*^9}},ExpressionUUID->"4aa00a9e-abb2-44bc-9eb9-\
501fe16706ba"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"In\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "11.333230014396305`"}], "-", 
     RowBox[{"4.687130200770895`", " ", "\[ImaginaryI]"}]}]}], ",", 
   RowBox[{"\<\"Up\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "1.3235562374587524`"}], "-", 
     RowBox[{"2.189081510133343`", " ", "\[ImaginaryI]"}]}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.767811662770327*^9},ExpressionUUID->"43d0f2bd-bac3-46b6-8db2-\
42c76d6a875d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Renormalized angular momentum", "Section",
 CellChangeTimes->{{3.767811749845207*^9, 
  3.767811759475627*^9}},ExpressionUUID->"319cf769-7f11-4188-adb1-\
31d08246013c"],

Cell["\<\
There are two methods for computing the renormalized angular momentum. The \
series method is not yet fully implemented (but is the default). The \
Monodromy method is usually robust so long as high precision values are \
entered. Note also that the input parameter is \[Epsilon] = 2M\[Omega]. This \
will likely change soon to be \[Omega].\
\>", "Text",
 CellChangeTimes->{{3.767811825955367*^9, 
  3.767811907960515*^9}},ExpressionUUID->"0635deb8-2a09-4d4d-a26a-\
8816386cf136"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RenormalizedAngularMomentum", "[", 
  RowBox[{"1", ",", "2", ",", "1", ",", "0.9`32", ",", "0.5`32", ",", 
   RowBox[{"Method", "\[Rule]", "\"\<Monodromy\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.767811772192395*^9, 3.767811814313933*^9}, {
  3.767811914176736*^9, 
  3.767811914368009*^9}},ExpressionUUID->"73866227-125e-4545-bf8e-\
83876a988a1e"],

Cell[BoxData["1.89981031585600968192015215502647775531`25.700378951694397"], \
"Output",
 CellChangeTimes->{{3.767811789525043*^9, 3.767811814801139*^9}, 
   3.767811914694872*^9},ExpressionUUID->"aaf58f9c-6586-471d-8490-\
b4a72d862f52"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Fluxes ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"s", "=", 
     RowBox[{"-", "2"}]}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "96155055-5ee3-4342-9fc4-71538502b4b0"],
 " circular, equatorial only"
}], "Section",
 CellChangeTimes->{{3.767811249129651*^9, 
  3.767811271375554*^9}},ExpressionUUID->"53576b79-55d6-48ba-b7d7-\
a18ca9db63c0"],

Cell["\<\
Currently the Teukolsky source has only been implemented for s=-2 and for \
circular, equatorial orbits\
\>", "Text",
 CellChangeTimes->{{3.767811278783284*^9, 
  3.767811302822363*^9}},ExpressionUUID->"764a2eb2-48b2-4e66-87fa-\
3f862dd6b5ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", "0.9`32"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r0", "=", "10.`32"}], ";"}]}], "Input",
 CellChangeTimes->{{3.767811327734144*^9, 
  3.7678113439496517`*^9}},ExpressionUUID->"84bc161c-2e5a-4f62-995b-\
ab1d97502ac4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"orbit", "=", 
  RowBox[{"KerrGeoOrbit", "[", 
   RowBox[{"a", ",", "r0", ",", "0", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.767811323050275*^9, 3.767811358573811*^9}, 
   3.767811403147996*^9},ExpressionUUID->"ca139477-705e-482f-abf4-\
8c9cc2071b41"],

Cell[BoxData["\<\"KerrGeoOrbitFunction[0.90000000000000000000000000000000,10.\
000000000000000000000000000000,0,1.,<<>>]\"\>"], "Output",
 CellChangeTimes->{
  3.7678114034451447`*^9},ExpressionUUID->"8f26b8c8-2526-42c9-aaf3-\
ac4044035ad7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"-", "2"}]}], ";", 
  RowBox[{"l", "=", "2"}], ";", 
  RowBox[{"m", "=", "2"}], ";", 
  RowBox[{"n", "=", "0"}], ";", 
  RowBox[{"k", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mode", "=", 
  RowBox[{"TeukolskyPointParticleMode", "[", 
   RowBox[{"s", ",", "l", ",", "m", ",", "n", ",", "k", ",", "orbit"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.767811360836403*^9, 
  3.767811396090497*^9}},ExpressionUUID->"33ec66bd-5454-4fec-9990-\
affcd46ce618"],

Cell[BoxData["\<\"TeukolskyModeObject[-2,2,2,0,0,<<>>]\"\>"], "Output",
 CellChangeTimes->{
  3.767811397308297*^9},ExpressionUUID->"bf0a522e-8e3c-4d98-b383-\
b0694818a8c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", 
  RowBox[{"mode", "[", "\"\<Fluxes\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.767811405934141*^9, 3.7678114098579283`*^9}, 
   3.767811531423813*^9},ExpressionUUID->"52f158c7-8ad2-4a14-af57-\
40e9906411bf"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"FluxInf\"\>", "\[Rule]", 
    "0.00004454600110236099432689264704792693`16.92825059866689"}], ",", 
   RowBox[{"\<\"FluxHor\"\>", "\[Rule]", 
    RowBox[{"-", "1.19673584267667264545481999906`17.028262880617383*^-7"}]}],
    ",", 
   RowBox[{"\<\"FluxTotal\"\>", "\[Rule]", 
    "0.00004442632751809332706234716504802093`16.92615652867138"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.7678114102171164`*^9, 
  3.767811531809194*^9},ExpressionUUID->"e148e147-35ca-4bd0-960a-\
0d7a1f77bb30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R", "=", 
  RowBox[{"mode", "[", "\"\<Radial\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.767811417336772*^9, 
  3.767811424915506*^9}},ExpressionUUID->"9d4006b6-0413-4c4b-8c67-\
14946064d2ab"],

Cell[BoxData["\<\"TeukolskyRadialFunction[-2,2,2,0.\
90000000000000000000000000000000,0.06149536444857092909254283058,<<>>]\"\>"], \
"Output",
 CellChangeTimes->{{3.767811421310096*^9, 
  3.767811425398604*^9}},ExpressionUUID->"1f998ef8-7749-4467-b847-\
7d2d45c88acd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R", "[", "r0", "]"}]], "Input",
 CellChangeTimes->{{3.767811425879086*^9, 
  3.76781142810082*^9}},ExpressionUUID->"faa131ba-fc2b-4850-adc1-\
e9ebff1c216d"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"In\"\>", "\[Rule]", 
    RowBox[{
    "6923.43762519192312266419911119636107077645`18.630367534525753", "+", 
     RowBox[{
     "349.53753071987890688776786562019795706979`17.327794477117703", " ", 
      "\[ImaginaryI]"}]}]}], ",", 
   RowBox[{"\<\"Up\"\>", "\[Rule]", 
    RowBox[{
    "8719.11896417092391029294234311663288384521`19.211049911725297", "-", 
     RowBox[{
     "2411.28850085561695436454875284882321063655`18.64889355296173", " ", 
      "\[ImaginaryI]"}]}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.767811428474362*^9},ExpressionUUID->"48159779-dee9-494d-ac05-\
13fd567f6178"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1164, 728},
WindowMargins->{{Automatic, 121}, {Automatic, 0}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 179, 3, 98, "Title",ExpressionUUID->"6dfb92db-8d2f-412c-a2d2-ed2ea57ae5a7"],
Cell[762, 27, 319, 7, 35, "Text",ExpressionUUID->"ff74de42-b70c-4674-8db3-9eb3faa7e0d0"],
Cell[1084, 36, 180, 4, 30, "Input",ExpressionUUID->"fd89dbdb-cda3-401f-ba0a-942277a30a33"],
Cell[CellGroupData[{
Cell[1289, 44, 168, 3, 67, "Section",ExpressionUUID->"fb2c01ff-5454-49d0-b084-3d9988dd42a9"],
Cell[CellGroupData[{
Cell[1482, 51, 301, 8, 30, "Input",ExpressionUUID->"af0605f7-369b-4356-94a4-00eaa2af7dc6"],
Cell[1786, 61, 203, 3, 34, "Output",ExpressionUUID->"7302a87c-a1f3-4326-8fcf-b152f7ecb80e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2026, 69, 282, 6, 52, "Input",ExpressionUUID->"aed6e67a-c34c-4d43-a88c-46eddcdcfd7a"],
Cell[2311, 77, 600, 13, 34, "Output",ExpressionUUID->"0cc86216-b97b-422b-8bd2-3800c6d6d575"],
Cell[2914, 92, 318, 6, 34, "Output",ExpressionUUID->"aa3a311d-364e-437b-abd4-51e001f1859f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3269, 103, 129, 2, 30, "Input",ExpressionUUID->"757634c5-7c09-4347-98a9-6ea5de596742"],
Cell[3401, 107, 529, 13, 34, "Output",ExpressionUUID->"b813770d-457e-4632-8136-0b0ffa998873"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3967, 125, 201, 5, 30, "Input",ExpressionUUID->"5beb6aff-5e83-48d3-989c-d7bcb06b70c7"],
Cell[4171, 132, 527, 13, 34, "Output",ExpressionUUID->"b4aeba20-e729-426c-ae7b-babe86242998"]
}, Open  ]],
Cell[4713, 148, 243, 6, 35, "Text",ExpressionUUID->"a825781f-82aa-447e-a69f-f422113e978e"],
Cell[CellGroupData[{
Cell[4981, 158, 206, 5, 30, "Input",ExpressionUUID->"4aa00a9e-abb2-44bc-9eb9-501fe16706ba"],
Cell[5190, 165, 529, 14, 34, "Output",ExpressionUUID->"43d0f2bd-bac3-46b6-8db2-42c76d6a875d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5768, 185, 174, 3, 67, "Section",ExpressionUUID->"319cf769-7f11-4188-adb1-31d08246013c"],
Cell[5945, 190, 490, 9, 58, "Text",ExpressionUUID->"0635deb8-2a09-4d4d-a26a-8816386cf136"],
Cell[CellGroupData[{
Cell[6460, 203, 379, 7, 30, "Input",ExpressionUUID->"73866227-125e-4545-bf8e-83876a988a1e"],
Cell[6842, 212, 237, 4, 34, "Output",ExpressionUUID->"aaf58f9c-6586-471d-8490-b4a72d862f52"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7128, 222, 409, 13, 68, "Section",ExpressionUUID->"53576b79-55d6-48ba-b7d7-a18ca9db63c0"],
Cell[7540, 237, 253, 6, 35, "Text",ExpressionUUID->"764a2eb2-48b2-4e66-87fa-3f862dd6b5ad"],
Cell[7796, 245, 276, 7, 52, "Input",ExpressionUUID->"84bc161c-2e5a-4f62-995b-ab1d97502ac4"],
Cell[CellGroupData[{
Cell[8097, 256, 286, 6, 30, "Input",ExpressionUUID->"ca139477-705e-482f-abf4-8c9cc2071b41"],
Cell[8386, 264, 241, 4, 34, "Output",ExpressionUUID->"8f26b8c8-2526-42c9-aaf3-ac4044035ad7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8664, 273, 524, 14, 52, "Input",ExpressionUUID->"33ec66bd-5454-4fec-9990-affcd46ce618"],
Cell[9191, 289, 173, 3, 34, "Output",ExpressionUUID->"bf0a522e-8e3c-4d98-b383-b0694818a8c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9401, 297, 239, 5, 30, "Input",ExpressionUUID->"52f158c7-8ad2-4a14-af57-40e9906411bf"],
Cell[9643, 304, 582, 13, 37, "Output",ExpressionUUID->"e148e147-35ca-4bd0-960a-0d7a1f77bb30"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10262, 322, 219, 5, 30, "Input",ExpressionUUID->"9d4006b6-0413-4c4b-8c67-14946064d2ab"],
Cell[10484, 329, 268, 5, 34, "Output",ExpressionUUID->"1f998ef8-7749-4467-b847-7d2d45c88acd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10789, 339, 180, 4, 30, "Input",ExpressionUUID->"faa131ba-fc2b-4850-adc1-e9ebff1c216d"],
Cell[10972, 345, 692, 17, 34, "Output",ExpressionUUID->"48159779-dee9-494d-ac05-13fd567f6178"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

